---
title: android-service
date: 2019-06-28 17:22:44
tags: ["android","service"]
---

##### 说明
Service是可以在后台执行长时间运行的应用程序组件，它不提供用户界面。另一个应用程序组件可以启动服务，即使用户切换到另一个应用程序，它也会继续在后台运行。此外，组件可以绑定到服务以与其交互，甚至可以执行进程间通信（IPC）。例如，服务可以从后台处理网络事务，播放音乐，执行文件I/O或与ContentProvider交互。

* 前台服务
前台服务执行一些对用户来说很明显的操作。例如，音频应用程序将使用前台服务来播放音轨。前台服务必须显示通知。即使用户未与应用程序交互，前台服务也会继续运行。

* 后台服务
后台服务执行用户未直接注意到的操作。例如，如果应用程序使用服务来压缩其存储，那通常是后台服务。


当应用程序调用服务的bindService可以让组件与服务绑定在一起。服务提供了一套客户端与服务交互的接口，允许组件与服务交互，发送请求，接收结果，甚至跨进程通信（IPC）进行交互。服务只要绑定了一个应用程序组件，就会运行。多个组件可同时绑定到服务，但是当所有组件解除绑定时，服务将被销毁。

无论您的服务是启动，绑定还是两者兼而有之，**任何应用程序组件**都可以使用该服务，就像任何组件可以使用Activity一样(通过使用Intent）。但是，您可以在Manifest文件中将服务声明为私有，并阻止从其他应用程序访问。

<div class="tips">警告：服务在其托管进程的主线程中运行; 该服务并没有创建自己的线程，也不会在一个单独的进程，除非另行指定(如自己开辟新线程)。如果您的服务要执行任何CPU密集型工作或阻塞操作（如MP3播放或网络请求），则应在服务中创建新线程以完成该工作。通过使用单独的线程，您可以降低应用程序无响应（ANR）错误的风险，让用户可以继续与当前的Activity交互
</div>

##### 使用线程还是一个服务？
服务只是一个可以在后台运行的组件（即使用户没有与您的应用程序交互），因此您应该只在您需要的时候创建服务。

如果您必须在主线程之外执行工作，但仅在用户与您的应用程序交互时，您应该创建一个新线程。例如，如果您想播放一些音乐，但只有在您的活动正在运行时，您可以创建一个线程onCreate()，开始运行它onStart()并将其停止onStop()。还可以考虑使用AsyncTask或HandlerThread 代替传统Thread类。

请记住，如果您确实使用了服务，它默认仍然在应用程序的主线程中运行，因此如果它会执行密集或阻塞操作，您仍应在服务中创建新线程。

